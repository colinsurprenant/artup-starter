
/*
 * aciTypewriter jQuery Plugin v1.0
 * http://acoderinsights.ro
 *
 * Copyright (c) 2012 Dragos Ursu
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Require jQuery Library http://jquery.com
 *
 * Date: Fri Dec 14 23:05 2012 +0200
 */

(function(a){a.aciTypewriter={nameSpace:".aciTypewriter"};a.fn.aciTypewriter=function(c,e){var b=null;for(var d=0;d<this.length;d++){b=a(this[d])._aciTypewriter(c,e);if(!(b instanceof jQuery)){return b}}return this};a.fn.aciTypewriter.defaults={words:true,exclude:"script",compounds:"li:first,tr:first,table:first",objects:"img,br",effects:true,textDelay:10,fixDelay:true,compoundDelay:50,objectDelay:200,dataEntry:"twText",autoInit:true,autoStart:false,callbacks:{beforeInit:null,afterInit:null,beforeStart:null,afterFinish:null}};a.fn._aciTypewriter=function(c,k){var e=this;var s=this.data(a.aciTypewriter.nameSpace);if(!s&&((typeof c=="undefined")||(typeof c=="object"))){s={options:a.extend({},a.fn.aciTypewriter.defaults,c),tickInterval:null,wasInit:false,wasStart:false};this.data(a.aciTypewriter.nameSpace,s)}var i=function(){a.extend({},s,{isPaused:false,tickLast:null,tickText:null,tickLen:0,tickIndex:0,tickStart:0,tockAll:null,tockLen:0,tockIndex:0})};var p=function(u){var v=u.text();v=v.replace(/\s+/gm," ");if(v.length&&(v!=" ")){if(s.options.compounds){u.parents(s.options.compounds).addClass("typeWriter-parent").hide()}var t=a('<span class="typeWriter">').data(s.options.dataEntry,v);u.replaceWith(t)}};var g=function(){if(s.wasInit){return}s.wasInit=true;if(s.options.callbacks&&s.options.callbacks.beforeInit){s.options.callbacks.beforeInit(e)}e.contents().each(function(){if(typeof this.tagName=="undefined"){p(a(this))}});e.find("*").not(s.options.exclude).each(function(){a(this).contents().each(function(){if(typeof this.tagName=="undefined"){p(a(this))}})});if(s.options.objects){e.find(s.options.objects).addClass("typeWriter-hidden").hide()}if(s.options.callbacks&&s.options.callbacks.afterInit){s.options.callbacks.afterInit(e)}};var o=function(){if(!s.wasInit||s.wasStart){return}s.wasStart=true;if(s.options.callbacks&&s.options.callbacks.beforeStart){s.options.callbacks.beforeStart(e)}i();s.tickInterval=window.setTimeout(h,s.options.textDelay)};var q=function(){if(!s.wasInit||!s.wasStart){return}s.isPaused=true};var j=function(){if(!s.wasInit){return}if(s.wasStart){if(s.isPaused){s.isPaused=false;s.tickInterval=window.setTimeout(h,s.options.textDelay)}}else{o()}};var r=function(v,t,w,x){var u=a('<span class="typeWriter-item">').fadeTo(0,0.1);u.text(t);v.append(u);u.fadeTo(w,1,function(){var y=a(this);y.replaceWith(y.text());if(x){x()}s.tickInterval=window.setTimeout(h,w)})};var h=function(){window.clearTimeout(s.tickInterval);if(s.isPaused){return}if(s.tickLast){var t=s.tickLast}else{var t=s.tickLast=e.find(".typeWriter:eq(0)");s.tickText=t.data(s.options.dataEntry)||"";s.tickIndex=0;s.tickLen=s.tickText.length;if(s.options.objects){s.tockAll=e.find("*");if(t.get(0)){s.tockAll=s.tockAll.slice(0,s.tockAll.index(t)).filter(".typeWriter-hidden")}else{s.tockAll=s.tockAll.filter(".typeWriter-hidden")}s.tockLen=s.tockAll.length;if(s.tockLen){s.tockIndex=0;m();return}}}if(t.get(0)){if(s.options.compounds){t.parents(".typeWriter-parent").removeClass("typeWriter-parent").fadeIn(s.options.compoundDelay)}if(s.options.words){if(s.tickIndex<s.tickLen){var u=s.tickText.indexOf(" ",s.tickIndex);if(u==-1){s.tickLast.data(s.options.dataEntry,null);s.tickLast=null;if(s.options.effects){r(t,s.tickText.substr(s.tickIndex),s.options.fixDelay?s.options.textDelay:((s.tickLen-s.tickIndex)*s.options.textDelay),function(){t.replaceWith(s.tickText)})}else{t.replaceWith(s.tickText);s.tickInterval=window.setTimeout(h,s.options.fixDelay?s.options.textDelay:((s.tickLen-s.tickIndex)*s.options.textDelay))}}else{s.tickStart=s.tickIndex;s.tickIndex=u+1;if(s.options.effects){r(t,s.tickText.substr(s.tickStart,s.tickIndex-s.tickStart),s.options.fixDelay?s.options.textDelay:((s.tickIndex-s.tickStart)*s.options.textDelay))}else{t.append(s.tickText.substr(s.tickStart,s.tickIndex-s.tickStart));s.tickInterval=window.setTimeout(h,s.options.fixDelay?s.options.textDelay:((s.tickIndex-s.tickStart)*s.options.textDelay))}}}else{s.tickLast.data(s.options.dataEntry,null);s.tickLast=null;t.replaceWith(s.tickText);s.tickInterval=window.setTimeout(h,s.options.textDelay)}}else{if(s.tickIndex<s.tickLen){s.tickStart=s.tickIndex;s.tickIndex++;if(s.options.effects){r(t,s.tickText.substr(s.tickStart,1),s.options.textDelay)}else{t.append(s.tickText.substr(s.tickStart,1));s.tickInterval=window.setTimeout(h,s.options.textDelay)}}else{s.tickLast.data(s.options.dataEntry,null);s.tickLast=null;t.replaceWith(s.tickText);s.tickInterval=window.setTimeout(h,s.options.textDelay)}}}else{b()}};var m=function(){window.clearTimeout(s.tickInterval);if(s.isPaused){return}var t=s.tockAll.eq(s.tockIndex);s.tockIndex++;if(s.options.effects){t.removeClass("typeWriter-hidden").fadeIn(s.options.objectDelay,function(){s.tickInterval=window.setTimeout(m,s.options.objectDelay)})}else{t.removeClass("typeWriter-hidden").show()}if(s.tockIndex>s.tockLen){s.tickInterval=window.setTimeout(h,s.options.textDelay)}};var b=function(){s.wasStart=false;s.wasInit=false;if(s.options.callbacks&&s.options.callbacks.afterFinish){s.options.callbacks.afterFinish(e)}};var f=function(t){if(!s.wasInit){return false}q();window.setTimeout(function(){var u=s.options;s.options.effects=false;s.options.textDelay=0;s.options.fixDelay=true;s.options.compoundDelay=0;s.options.objectDelay=0;j();window.setTimeout(function(){s.options=u;b();if(t){t(e)}},50)},Math.max(s.options.textDelay,c.compoundDelay,s.options.objectDelay));return true};var l=function(){if((typeof c=="undefined")||(typeof c=="object")){d()}else{if(typeof c=="string"){switch(c){case"init":g();break;case"start":o();break;case"pause":q();break;case"resume":j();break;case"finish":f(k);break;case"options":return s.options;case"destroy":n();break}}}return e};var n=function(){if(s){if(!f(function(){e.data(a.aciTypewriter.nameSpace,null)})){e.data(a.aciTypewriter.nameSpace,null)}}};var d=function(){if(s.options.autoInit){g()}if(s.options.autoStart){o()}};return l()}})(jQuery);
